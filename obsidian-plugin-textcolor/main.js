/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => TextColorPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var ColorPicker = class {
  constructor() {
    this.hue = 0;
    this.saturation = 100;
    this.lightness = 50;
    this.opacity = 1;
  }
  setHue(hue) {
    this.hue = hue;
  }
  setSaturation(saturation) {
    this.saturation = saturation;
  }
  setLightness(lightness) {
    this.lightness = lightness;
  }
  setOpacity(opacity) {
    this.opacity = opacity;
  }
  convertToRGB() {
    const h = this.hue / 360;
    const s = this.saturation / 100;
    const l = this.lightness / 100;
    let r, g, b;
    if (s === 0) {
      r = g = b = l;
    } else {
      const hue2rgb = (p2, q2, t) => {
        if (t < 0)
          t += 1;
        if (t > 1)
          t -= 1;
        if (t < 1 / 6)
          return p2 + (q2 - p2) * 6 * t;
        if (t < 1 / 2)
          return q2;
        if (t < 2 / 3)
          return p2 + (q2 - p2) * (2 / 3 - t) * 6;
        return p2;
      };
      const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
      const p = 2 * l - q;
      r = hue2rgb(p, q, h + 1 / 3);
      g = hue2rgb(p, q, h);
      b = hue2rgb(p, q, h - 1 / 3);
    }
    return { r: Math.round(r * 255), g: Math.round(g * 255), b: Math.round(b * 255), a: this.opacity };
  }
  getHex() {
    const rgbColor = this.convertToRGB();
    return this.rgbToHex(rgbColor.r, rgbColor.g, rgbColor.b, rgbColor.a);
  }
  setFromHex(hex) {
    const r = parseInt(hex.slice(1, 3), 16);
    const g = parseInt(hex.slice(3, 5), 16);
    const b = parseInt(hex.slice(5, 7), 16);
    let a;
    if (hex.length === 9) {
      a = parseInt(hex.slice(7, 9), 16) / 255;
    } else {
      a = 1;
    }
    this.hue = this.rgbToHue(r, g, b);
    this.saturation = this.rgbToSaturation(r, g, b);
    this.lightness = this.rgbToLightness(r, g, b);
    this.opacity = a;
  }
  rgbToHex(r, g, b, a) {
    const hex = (n) => n.toString(16).padStart(2, "0");
    const aHex = Math.round(a * 255);
    return `#${hex(r)}${hex(g)}${hex(b)}${hex(aHex)}`;
  }
  rgbToHue(r, g, b) {
    r /= 255;
    g /= 255;
    b /= 255;
    const max = Math.max(r, g, b);
    const min = Math.min(r, g, b);
    let h = 0;
    if (max !== min) {
      const d = max - min;
      switch (max) {
        case r:
          h = (g - b) / d + (g < b ? 6 : 0);
          break;
        case g:
          h = (b - r) / d + 2;
          break;
        case b:
          h = (r - g) / d + 4;
          break;
      }
      h /= 6;
    }
    return Math.round(h * 360);
  }
  rgbToSaturation(r, g, b) {
    r /= 255;
    g /= 255;
    b /= 255;
    const max = Math.max(r, g, b);
    const min = Math.min(r, g, b);
    let s, l;
    l = (max + min) / 2;
    if (max === min) {
      s = 0;
    } else {
      const d = max - min;
      s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
    }
    return Math.round(s * 100);
  }
  rgbToLightness(r, g, b) {
    r /= 255;
    g /= 255;
    b /= 255;
    const max = Math.max(r, g, b);
    const min = Math.min(r, g, b);
    let l;
    l = (max + min) / 2;
    return Math.round(l * 100);
  }
};
var ColorPickerModal = class extends import_obsidian.Modal {
  constructor(app, colorPicker) {
    super(app);
    this.colorPicker = colorPicker;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h3", { text: "Choose a color" });
    new import_obsidian.Setting(contentEl).setName("Hue").addSlider((slider) => slider.setLimits(0, 360, 1).setValue(this.colorPicker.hue).onChange((value) => {
      this.colorPicker.setHue(value);
      this.updateHexInput();
      this.updateColorPreview();
    }));
    new import_obsidian.Setting(contentEl).setName("Saturation").addSlider((slider) => slider.setLimits(0, 100, 1).setValue(this.colorPicker.saturation).onChange((value) => {
      this.colorPicker.setSaturation(value);
      this.updateHexInput();
      this.updateColorPreview();
    }));
    new import_obsidian.Setting(contentEl).setName("Lightness").addSlider((slider) => slider.setLimits(0, 100, 1).setValue(this.colorPicker.lightness).onChange((value) => {
      this.colorPicker.setLightness(value);
      this.updateHexInput();
      this.updateColorPreview();
    }));
    new import_obsidian.Setting(contentEl).setName("Opacity").addSlider((slider) => slider.setLimits(0, 1, 0.01).setValue(this.colorPicker.opacity).onChange((value) => {
      this.colorPicker.setOpacity(value);
      this.updateHexInput();
      this.updateColorPreview();
    }));
    new import_obsidian.Setting(contentEl).setName("HEX").addText((text) => {
      text.inputEl.type = "text";
      text.inputEl.pattern = "[#][0-9a-fA-F]{6,8}";
      text.setValue(this.colorPicker.getHex());
      text.onChange((value) => {
        if (/^#[0-9a-fA-F]{6,8}$/.test(value)) {
          this.colorPicker.setFromHex(value);
          this.updateSliders();
          this.updateColorPreview();
        }
      });
      this.hexInput = text.inputEl;
    });
    this.colorPreviewBox = contentEl.createEl("div", { cls: "color-preview-box" });
    this.colorPreviewBox.style.height = "50px";
    this.colorPreviewBox.style.width = "100%";
    this.colorPreviewBox.style.border = "1px solid #ddd";
    this.updateColorPreview();
    new import_obsidian.Setting(contentEl).addButton((button) => {
      button.setButtonText("Save").onClick(() => {
        const rgbColor = this.colorPicker.convertToRGB();
        const colorString = `rgba(${rgbColor.r}, ${rgbColor.g}, ${rgbColor.b}, ${rgbColor.a})`;
        document.documentElement.style.setProperty("--selected-color", colorString);
        new import_obsidian.Notice(`Color ${colorString} saved!`);
        this.close();
      });
    });
  }
  updateHexInput() {
    const rgbColor = this.colorPicker.convertToRGB();
    this.hexInput.value = this.colorPicker.rgbToHex(rgbColor.r, rgbColor.g, rgbColor.b, rgbColor.a);
  }
  updateSliders() {
  }
  updateColorPreview() {
    const hexColor = this.colorPicker.getHex();
    this.colorPreviewBox.style.backgroundColor = hexColor;
  }
};
var TextColorPlugin = class extends import_obsidian.Plugin {
  async onload() {
    this.addCommand({
      id: "textcolor",
      name: "Change Text Color",
      callback: () => {
        const colorPicker = new ColorPicker();
        new ColorPickerModal(this.app, colorPicker).open();
      }
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgTW9kYWwsIEFwcCwgU2V0dGluZywgTm90aWNlLCBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG5pbnRlcmZhY2UgQ29sb3Ige1xyXG4gIHI6IG51bWJlcjtcclxuICBnOiBudW1iZXI7XHJcbiAgYjogbnVtYmVyO1xyXG59XHJcblxyXG5jbGFzcyBDb2xvclBpY2tlciB7XHJcbiAgaHVlOiBudW1iZXI7XHJcbiAgc2F0dXJhdGlvbjogbnVtYmVyO1xyXG4gIGxpZ2h0bmVzczogbnVtYmVyO1xyXG4gIG9wYWNpdHk6IG51bWJlcjtcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLmh1ZSA9IDA7XHJcbiAgICB0aGlzLnNhdHVyYXRpb24gPSAxMDA7XHJcbiAgICB0aGlzLmxpZ2h0bmVzcyA9IDUwO1xyXG4gICAgdGhpcy5vcGFjaXR5ID0gMTtcclxuICB9XHJcblxyXG4gIHNldEh1ZShodWU6IG51bWJlcikge1xyXG4gICAgdGhpcy5odWUgPSBodWU7XHJcbiAgfVxyXG5cclxuICBzZXRTYXR1cmF0aW9uKHNhdHVyYXRpb246IG51bWJlcikge1xyXG4gICAgdGhpcy5zYXR1cmF0aW9uID0gc2F0dXJhdGlvbjtcclxuICB9XHJcblxyXG4gIHNldExpZ2h0bmVzcyhsaWdodG5lc3M6IG51bWJlcikge1xyXG4gICAgdGhpcy5saWdodG5lc3MgPSBsaWdodG5lc3M7XHJcbiAgfVxyXG5cclxuICBzZXRPcGFjaXR5KG9wYWNpdHk6IG51bWJlcikge1xyXG4gICAgdGhpcy5vcGFjaXR5ID0gb3BhY2l0eTtcclxuICB9XHJcblxyXG4gIGNvbnZlcnRUb1JHQigpOiB7IHI6IG51bWJlcjsgZzogbnVtYmVyOyBiOiBudW1iZXI7IGE6IG51bWJlciB9IHtcclxuICAgIGNvbnN0IGggPSB0aGlzLmh1ZSAvIDM2MDtcclxuICAgIGNvbnN0IHMgPSB0aGlzLnNhdHVyYXRpb24gLyAxMDA7XHJcbiAgICBjb25zdCBsID0gdGhpcy5saWdodG5lc3MgLyAxMDA7XHJcbiAgICBsZXQgciwgZywgYjtcclxuXHJcbiAgICBpZiAocyA9PT0gMCkge1xyXG4gICAgICByID0gZyA9IGIgPSBsOyAvLyBhY2hyb21hdGljXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zdCBodWUycmdiID0gKHA6IG51bWJlciwgcTogbnVtYmVyLCB0OiBudW1iZXIpID0+IHtcclxuICAgICAgICBpZiAodCA8IDApIHQgKz0gMTtcclxuICAgICAgICBpZiAodCA+IDEpIHQgLT0gMTtcclxuICAgICAgICBpZiAodCA8IDEgLyA2KSByZXR1cm4gcCArIChxIC0gcCkgKiA2ICogdDtcclxuICAgICAgICBpZiAodCA8IDEgLyAyKSByZXR1cm4gcTtcclxuICAgICAgICBpZiAodCA8IDIgLyAzKSByZXR1cm4gcCArIChxIC0gcCkgKiAoMiAvIDMgLSB0KSAqIDY7XHJcbiAgICAgICAgcmV0dXJuIHA7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCBxID0gbCA8IDAuNSA/IGwgKiAoMSArIHMpIDogbCArIHMgLSBsICogcztcclxuICAgICAgY29uc3QgcCA9IDIgKiBsIC0gcTtcclxuICAgICAgciA9IGh1ZTJyZ2IocCwgcSwgaCArIDEgLyAzKTtcclxuICAgICAgZyA9IGh1ZTJyZ2IocCwgcSwgaCk7XHJcbiAgICAgIGIgPSBodWUycmdiKHAsIHEsIGggLSAxIC8gMyk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgcjogTWF0aC5yb3VuZChyICogMjU1KSwgZzogTWF0aC5yb3VuZChnICogMjU1KSwgYjogTWF0aC5yb3VuZChiICogMjU1KSwgYTogdGhpcy5vcGFjaXR5IH07XHJcbiAgfVxyXG5cclxuICBnZXRIZXgoKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IHJnYkNvbG9yID0gdGhpcy5jb252ZXJ0VG9SR0IoKTtcclxuICAgIHJldHVybiB0aGlzLnJnYlRvSGV4KHJnYkNvbG9yLnIsIHJnYkNvbG9yLmcsIHJnYkNvbG9yLmIsIHJnYkNvbG9yLmEpO1xyXG4gIH1cclxuXHJcbiAgc2V0RnJvbUhleChoZXg6IHN0cmluZykge1xyXG4gICAgY29uc3QgciA9IHBhcnNlSW50KGhleC5zbGljZSgxLCAzKSwgMTYpO1xyXG4gICAgY29uc3QgZyA9IHBhcnNlSW50KGhleC5zbGljZSgzLCA1KSwgMTYpO1xyXG4gICAgY29uc3QgYiA9IHBhcnNlSW50KGhleC5zbGljZSg1LCA3KSwgMTYpO1xyXG4gICAgbGV0IGE7XHJcbiAgICBpZiAoaGV4Lmxlbmd0aCA9PT0gOSkge1xyXG4gICAgICBhID0gcGFyc2VJbnQoaGV4LnNsaWNlKDcsIDkpLCAxNikgLyAyNTU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBhID0gMTsgLy8gZGVmYXVsdCB0byBmdWxseSBvcGFxdWUgaWYgYWxwaGEgY2hhbm5lbCBpcyBub3QgcHJvdmlkZWRcclxuICAgIH1cclxuICAgIHRoaXMuaHVlID0gdGhpcy5yZ2JUb0h1ZShyLCBnLCBiKTtcclxuICAgIHRoaXMuc2F0dXJhdGlvbiA9IHRoaXMucmdiVG9TYXR1cmF0aW9uKHIsIGcsIGIpO1xyXG4gICAgdGhpcy5saWdodG5lc3MgPSB0aGlzLnJnYlRvTGlnaHRuZXNzKHIsIGcsIGIpO1xyXG4gICAgdGhpcy5vcGFjaXR5ID0gYTtcclxuICB9XHJcbiAgXHJcbiAgXHJcbiAgXHJcbiAgXHJcblxyXG4gIFxyXG5cclxuICByZ2JUb0hleChyOiBudW1iZXIsIGc6IG51bWJlciwgYjogbnVtYmVyLCBhOiBudW1iZXIpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgaGV4ID0gKG46IG51bWJlcikgPT4gbi50b1N0cmluZygxNikucGFkU3RhcnQoMiwgJzAnKTtcclxuICAgIGNvbnN0IGFIZXggPSBNYXRoLnJvdW5kKGEgKiAyNTUpO1xyXG4gICAgcmV0dXJuIGAjJHtoZXgocil9JHtoZXgoZyl9JHtoZXgoYil9JHtoZXgoYUhleCl9YDtcclxuICB9XHJcblxyXG4gIHJnYlRvSHVlKHI6IG51bWJlciwgZzogbnVtYmVyLCBiOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgciAvPSAyNTU7XHJcbiAgICBnIC89IDI1NTtcclxuICAgIGIgLz0gMjU1O1xyXG4gICAgY29uc3QgbWF4ID0gTWF0aC5tYXgociwgZywgYik7XHJcbiAgICBjb25zdCBtaW4gPSBNYXRoLm1pbihyLCBnLCBiKTtcclxuICAgIGxldCBoID0gMDtcclxuXHJcbiAgICBpZiAobWF4ICE9PSBtaW4pIHtcclxuICAgICAgY29uc3QgZCA9IG1heCAtIG1pbjtcclxuICAgICAgc3dpdGNoIChtYXgpIHtcclxuICAgICAgICBjYXNlIHI6XHJcbiAgICAgICAgICBoID0gKGcgLSBiKSAvIGQgKyAoZyA8IGIgPyA2IDogMCk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIGc6XHJcbiAgICAgICAgICBoID0gKGIgLSByKSAvIGQgKyAyO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBiOlxyXG4gICAgICAgICAgaCA9IChyIC0gZykgLyBkICsgNDtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGggLz0gNjtcclxuICAgIH1cclxuICAgIHJldHVybiBNYXRoLnJvdW5kKGggKiAzNjApO1xyXG4gIH1cclxuXHJcbiAgcmdiVG9TYXR1cmF0aW9uKHI6IG51bWJlciwgZzogbnVtYmVyLCBiOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgciAvPSAyNTU7XHJcbiAgICBnIC89IDI1NTtcclxuICAgIGIgLz0gMjU1O1xyXG4gICAgY29uc3QgbWF4ID0gTWF0aC5tYXgociwgZywgYik7XHJcbiAgICBjb25zdCBtaW4gPSBNYXRoLm1pbihyLCBnLCBiKTtcclxuICAgIGxldCBzOiBudW1iZXIsIGw6IG51bWJlcjtcclxuXHJcbiAgICBsID0gKG1heCArIG1pbikgLyAyO1xyXG5cclxuICAgIGlmIChtYXggPT09IG1pbikge1xyXG4gICAgICBzID0gMDsgLy8gYWNocm9tYXRpY1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc3QgZCA9IG1heCAtIG1pbjtcclxuICAgICAgcyA9IGwgPiAwLjUgPyBkIC8gKDIgLSBtYXggLSBtaW4pIDogZCAvIChtYXggKyBtaW4pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIE1hdGgucm91bmQocyAqIDEwMCk7XHJcbiAgfVxyXG5cclxuICByZ2JUb0xpZ2h0bmVzcyhyOiBudW1iZXIsIGc6IG51bWJlciwgYjogbnVtYmVyKTogbnVtYmVyIHtcclxuICAgIHIgLz0gMjU1O1xyXG4gICAgZyAvPSAyNTU7XHJcbiAgICBiIC89IDI1NTtcclxuICAgIGNvbnN0IG1heCA9IE1hdGgubWF4KHIsIGcsIGIpO1xyXG4gICAgY29uc3QgbWluID0gTWF0aC5taW4ociwgZywgYik7XHJcbiAgICBsZXQgbDogbnVtYmVyO1xyXG5cclxuICAgIGwgPSAobWF4ICsgbWluKSAvIDI7XHJcblxyXG4gICAgcmV0dXJuIE1hdGgucm91bmQobCAqIDEwMCk7XHJcbiAgfVxyXG59XHJcblxyXG5jbGFzcyBDb2xvclBpY2tlck1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gIGNvbG9yUGlja2VyOiBDb2xvclBpY2tlcjtcclxuICBoZXhJbnB1dDogSFRNTElucHV0RWxlbWVudDtcclxuICBjb2xvclByZXZpZXdCb3g6IEhUTUxFbGVtZW50O1xyXG5cclxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgY29sb3JQaWNrZXI6IENvbG9yUGlja2VyKSB7XHJcbiAgICBzdXBlcihhcHApO1xyXG4gICAgdGhpcy5jb2xvclBpY2tlciA9IGNvbG9yUGlja2VyO1xyXG4gIH1cclxuXHJcbiAgb25PcGVuKCkge1xyXG4gICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnQ2hvb3NlIGEgY29sb3InIH0pO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgLnNldE5hbWUoJ0h1ZScpXHJcbiAgICAgIC5hZGRTbGlkZXIoc2xpZGVyID0+IHNsaWRlclxyXG4gICAgICAgIC5zZXRMaW1pdHMoMCwgMzYwLCAxKVxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLmNvbG9yUGlja2VyLmh1ZSlcclxuICAgICAgICAub25DaGFuZ2UoKHZhbHVlOiBudW1iZXIpID0+IHtcclxuICAgICAgICAgIHRoaXMuY29sb3JQaWNrZXIuc2V0SHVlKHZhbHVlKTtcclxuICAgICAgICAgIHRoaXMudXBkYXRlSGV4SW5wdXQoKTtcclxuICAgICAgICAgIHRoaXMudXBkYXRlQ29sb3JQcmV2aWV3KCk7XHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgLnNldE5hbWUoJ1NhdHVyYXRpb24nKVxyXG4gICAgICAuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcclxuICAgICAgICAuc2V0TGltaXRzKDAsIDEwMCwgMSlcclxuICAgICAgICAuc2V0VmFsdWUodGhpcy5jb2xvclBpY2tlci5zYXR1cmF0aW9uKVxyXG4gICAgICAgIC5vbkNoYW5nZSgodmFsdWU6IG51bWJlcikgPT4ge1xyXG4gICAgICAgICAgdGhpcy5jb2xvclBpY2tlci5zZXRTYXR1cmF0aW9uKHZhbHVlKTtcclxuICAgICAgICAgIHRoaXMudXBkYXRlSGV4SW5wdXQoKTtcclxuICAgICAgICAgIHRoaXMudXBkYXRlQ29sb3JQcmV2aWV3KCk7XHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgLnNldE5hbWUoJ0xpZ2h0bmVzcycpXHJcbiAgICAgIC5hZGRTbGlkZXIoc2xpZGVyID0+IHNsaWRlclxyXG4gICAgICAgIC5zZXRMaW1pdHMoMCwgMTAwLCAxKVxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLmNvbG9yUGlja2VyLmxpZ2h0bmVzcylcclxuICAgICAgICAub25DaGFuZ2UoKHZhbHVlOiBudW1iZXIpID0+IHtcclxuICAgICAgICAgIHRoaXMuY29sb3JQaWNrZXIuc2V0TGlnaHRuZXNzKHZhbHVlKTtcclxuICAgICAgICAgIHRoaXMudXBkYXRlSGV4SW5wdXQoKTtcclxuICAgICAgICAgIHRoaXMudXBkYXRlQ29sb3JQcmV2aWV3KCk7XHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgLnNldE5hbWUoJ09wYWNpdHknKVxyXG4gICAgICAuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcclxuICAgICAgICAuc2V0TGltaXRzKDAsIDEsIDAuMDEpXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMuY29sb3JQaWNrZXIub3BhY2l0eSlcclxuICAgICAgICAub25DaGFuZ2UoKHZhbHVlOiBudW1iZXIpID0+IHtcclxuICAgICAgICAgIHRoaXMuY29sb3JQaWNrZXIuc2V0T3BhY2l0eSh2YWx1ZSk7XHJcbiAgICAgICAgICB0aGlzLnVwZGF0ZUhleElucHV0KCk7XHJcbiAgICAgICAgICB0aGlzLnVwZGF0ZUNvbG9yUHJldmlldygpO1xyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAgIC5zZXROYW1lKCdIRVgnKVxyXG4gICAgICAgIC5hZGRUZXh0KHRleHQgPT4ge1xyXG4gICAgICAgICAgdGV4dC5pbnB1dEVsLnR5cGUgPSAndGV4dCc7XHJcbiAgICAgICAgICB0ZXh0LmlucHV0RWwucGF0dGVybiA9ICdbI11bMC05YS1mQS1GXXs2LDh9JztcclxuICAgICAgICAgIHRleHQuc2V0VmFsdWUodGhpcy5jb2xvclBpY2tlci5nZXRIZXgoKSk7XHJcbiAgICAgICAgICB0ZXh0Lm9uQ2hhbmdlKCh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICgvXiNbMC05YS1mQS1GXXs2LDh9JC8udGVzdCh2YWx1ZSkpIHtcclxuICAgICAgICAgICAgICB0aGlzLmNvbG9yUGlja2VyLnNldEZyb21IZXgodmFsdWUpO1xyXG4gICAgICAgICAgICAgIHRoaXMudXBkYXRlU2xpZGVycygpO1xyXG4gICAgICAgICAgICAgIHRoaXMudXBkYXRlQ29sb3JQcmV2aWV3KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgdGhpcy5oZXhJbnB1dCA9IHRleHQuaW5wdXRFbDtcclxuICAgICAgICB9KTsgICAgICBcclxuICAgICAgXHJcbiAgICAgIFxyXG4gICAgICBcclxuXHJcbiAgICB0aGlzLmNvbG9yUHJldmlld0JveCA9IGNvbnRlbnRFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdjb2xvci1wcmV2aWV3LWJveCcgfSk7XHJcbiAgICB0aGlzLmNvbG9yUHJldmlld0JveC5zdHlsZS5oZWlnaHQgPSAnNTBweCc7XHJcbiAgICB0aGlzLmNvbG9yUHJldmlld0JveC5zdHlsZS53aWR0aCA9ICcxMDAlJztcclxuICAgIHRoaXMuY29sb3JQcmV2aWV3Qm94LnN0eWxlLmJvcmRlciA9ICcxcHggc29saWQgI2RkZCc7XHJcbiAgICB0aGlzLnVwZGF0ZUNvbG9yUHJldmlldygpO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4ge1xyXG4gICAgICAgIGJ1dHRvbi5zZXRCdXR0b25UZXh0KCdTYXZlJylcclxuICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcmdiQ29sb3IgPSB0aGlzLmNvbG9yUGlja2VyLmNvbnZlcnRUb1JHQigpO1xyXG4gICAgICAgICAgICBjb25zdCBjb2xvclN0cmluZyA9IGByZ2JhKCR7cmdiQ29sb3Iucn0sICR7cmdiQ29sb3IuZ30sICR7cmdiQ29sb3IuYn0sICR7cmdiQ29sb3IuYX0pYDtcclxuICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCctLXNlbGVjdGVkLWNvbG9yJywgY29sb3JTdHJpbmcpO1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKGBDb2xvciAke2NvbG9yU3RyaW5nfSBzYXZlZCFgKTtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB1cGRhdGVIZXhJbnB1dCgpIHtcclxuICAgIGNvbnN0IHJnYkNvbG9yID0gdGhpcy5jb2xvclBpY2tlci5jb252ZXJ0VG9SR0IoKTtcclxuICAgIHRoaXMuaGV4SW5wdXQudmFsdWUgPSB0aGlzLmNvbG9yUGlja2VyLnJnYlRvSGV4KHJnYkNvbG9yLnIsIHJnYkNvbG9yLmcsIHJnYkNvbG9yLmIsIHJnYkNvbG9yLmEpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB1cGRhdGVTbGlkZXJzKCkge1xyXG4gICAgLy8gVXBkYXRlIGh1ZSwgc2F0dXJhdGlvbnNzLCBsaWdodG5lLCBhbmQgb3BhY2l0eSBzbGlkZXJzIGJhc2VkIG9uIHRoZSBIRVggdmFsdWVcclxuICAgIC8vIC4uLlxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB1cGRhdGVDb2xvclByZXZpZXcoKSB7XHJcbiAgICBjb25zdCBoZXhDb2xvciA9IHRoaXMuY29sb3JQaWNrZXIuZ2V0SGV4KCk7XHJcbiAgICB0aGlzLmNvbG9yUHJldmlld0JveC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBoZXhDb2xvcjtcclxuICB9XHJcbn1cclxuXHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGV4dENvbG9yUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuICBhc3luYyBvbmxvYWQoKSB7XHJcbiAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICBpZDogJ3RleHRjb2xvcicsXHJcbiAgICAgIG5hbWU6ICdDaGFuZ2UgVGV4dCBDb2xvcicsXHJcbiAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgY29sb3JQaWNrZXIgPSBuZXcgQ29sb3JQaWNrZXIoKTtcclxuICAgICAgICBuZXcgQ29sb3JQaWNrZXJNb2RhbCh0aGlzLmFwcCwgY29sb3JQaWNrZXIpLm9wZW4oKTtcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gIH1cclxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxzQkFBb0Q7QUFRcEQsSUFBTSxjQUFOLE1BQWtCO0FBQUEsRUFNaEIsY0FBYztBQUNaLFNBQUssTUFBTTtBQUNYLFNBQUssYUFBYTtBQUNsQixTQUFLLFlBQVk7QUFDakIsU0FBSyxVQUFVO0FBQUEsRUFDakI7QUFBQSxFQUVBLE9BQU8sS0FBYTtBQUNsQixTQUFLLE1BQU07QUFBQSxFQUNiO0FBQUEsRUFFQSxjQUFjLFlBQW9CO0FBQ2hDLFNBQUssYUFBYTtBQUFBLEVBQ3BCO0FBQUEsRUFFQSxhQUFhLFdBQW1CO0FBQzlCLFNBQUssWUFBWTtBQUFBLEVBQ25CO0FBQUEsRUFFQSxXQUFXLFNBQWlCO0FBQzFCLFNBQUssVUFBVTtBQUFBLEVBQ2pCO0FBQUEsRUFFQSxlQUErRDtBQUM3RCxVQUFNLElBQUksS0FBSyxNQUFNO0FBQ3JCLFVBQU0sSUFBSSxLQUFLLGFBQWE7QUFDNUIsVUFBTSxJQUFJLEtBQUssWUFBWTtBQUMzQixRQUFJLEdBQUcsR0FBRztBQUVWLFFBQUksTUFBTSxHQUFHO0FBQ1gsVUFBSSxJQUFJLElBQUk7QUFBQSxJQUNkLE9BQU87QUFDTCxZQUFNLFVBQVUsQ0FBQ0EsSUFBV0MsSUFBVyxNQUFjO0FBQ25ELFlBQUksSUFBSTtBQUFHLGVBQUs7QUFDaEIsWUFBSSxJQUFJO0FBQUcsZUFBSztBQUNoQixZQUFJLElBQUksSUFBSTtBQUFHLGlCQUFPRCxNQUFLQyxLQUFJRCxNQUFLLElBQUk7QUFDeEMsWUFBSSxJQUFJLElBQUk7QUFBRyxpQkFBT0M7QUFDdEIsWUFBSSxJQUFJLElBQUk7QUFBRyxpQkFBT0QsTUFBS0MsS0FBSUQsT0FBTSxJQUFJLElBQUksS0FBSztBQUNs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
